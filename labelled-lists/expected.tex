% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\title{Labelled-lists - Custom labelled lists in Pandoc's markdown}
\author{Julien Dutant}
\date{}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Labelled-lists - Custom labelled lists in Pandoc's markdown},
  pdfauthor={Julien Dutant},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\newenvironment{Shaded}{}{}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{#1}}}}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% labelled-lists: code for crossreferencing by custom labels
\makeatletter
    \def\labelledlistlabel#1#2{\begingroup
    \def\@currentlabel{#2}%
    \label{#1}\endgroup
    }
\makeatother
  
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\begin{document}
\maketitle

\hypertarget{labelled-lists}{%
\section{Labelled-lists}\label{labelled-lists}}

custom labelled lists in Pandoc's markdown.

v0.1. Copyright: Â© 2021 Julien Dutant
\href{mailto:julien.dutant@kcl.ac.uk}{\nolinkurl{julien.dutant@kcl.ac.uk}}
License: MIT - see LICENSE file for details.

\hypertarget{introduction}{%
\subsection{Introduction}\label{introduction}}

This filter provides custom labelled lists in Pandoc's markdown for
outputs in LaTeX/PDF, HTML and JATS XML. Instead of bullets or numbers,
list items are given custom text labels. The text labels can include
markdown formatting.

\hypertarget{usage}{%
\subsection{Usage}\label{usage}}

\hypertarget{loading-the-filter}{%
\subsubsection{Loading the filter}\label{loading-the-filter}}

The filter is loaded with the Pandoc \texttt{-L} or
\texttt{-\/-lua-filter} option.

\texttt{bash\ pandoc\ -L\ path/to/labelled-lists.lua\ source.md\ -o\ output.html}

If the filter is in Pandoc's \texttt{\$DATADIR} there is no need to give
its path. See {[}Pandoc's manual{[}
(https://pandoc.org/MANUAL.html\#general-options) for details.

\hypertarget{markdown-syntax}{%
\subsubsection{Markdown syntax}\label{markdown-syntax}}

A simple illustration of the custom label syntax:

\begin{Shaded}
\begin{Highlighting}[]
\SpecialStringTok{* }\CommentTok{[}\OtherTok{Premise 1}\CommentTok{]}\NormalTok{\{\} This is the first claim.}
\SpecialStringTok{* }\CommentTok{[}\OtherTok{Premise 2}\CommentTok{]}\NormalTok{\{\} This is the second claim.}
\SpecialStringTok{* }\CommentTok{[}\OtherTok{Conclusion}\CommentTok{]}\NormalTok{\{\} This is the conclusion.}
\end{Highlighting}
\end{Shaded}

This generates the following list (process this file with the filter to
see the result):

\begin{itemize}
\tightlist

\item[(Premise 1)] This is the first claim.

\item[(Premise 2)] This is the second claim.

\item[(Conclusion)] This is the conclusion.

\end{itemize}

In general, the filter will turn a bullet list into a custom label list
provided that \emph{every item starts with a non-empty Span element}.

\begin{itemize}
\tightlist
\item
  A Span element is inline text (i.e., not block like a paragraph) that
  optinally has some attributes. The default syntax is
  \texttt{{[}inline\ text{]}\{attributes\}}. Inline text will be used as
  label, placed within round bracket.
\item
  There is no need to specify attributes on the Span. But curly brackets
  must be present: \texttt{{[}label{]}} won't work,
  \texttt{{[}label{]}\{\}} will.
\item
  The label can include formatting. \texttt{{[}**T1**{]}\{\}} will
  generate a label with strong emphasis (bold by default).
\item
  For the purposes of this filter, a Span is \emph{non-empty} if its
  inline text is not empty. Thus \texttt{{[}{]}\{\}} will not work.
  Numbers or other unicode characters work. To generate an empty label,
  use a space or other invisible character,
  e.g.~\texttt{{[}\ {]}\ \ \ \{\}}. \emph{Exception}: math formulas will
  work as labels, but if the inline text only contains LaTeX code
  (\texttt{\textbackslash{}textsc\{a\}}) it will be treated as empty.
\item
  Span elements can also be entered using HTML syntax:
  \texttt{\textless{}span\textgreater{}inline\ text\ \ \ \textless{}/span\textgreater{}}.
  See {[}Pandoc manual{]}
  (https://pandoc.org/MANUAL.html\#divs-and-spans) for details.
\end{itemize}

\hypertarget{cross-referencing-custom-label-items}{%
\subsubsection{Cross-referencing custom-label
items}\label{cross-referencing-custom-label-items}}

Custom labels can be given internal identifiers:

\begin{Shaded}
\begin{Highlighting}[]
\SpecialStringTok{* }\CommentTok{[}\OtherTok{**A1**}\CommentTok{]}\NormalTok{\{\#A1ref\} This is the first claim.}
\SpecialStringTok{* }\CommentTok{[}\OtherTok{A2}\CommentTok{]}\NormalTok{\{\#A2ref\} This is the second claim.}
\SpecialStringTok{* }\CommentTok{[}\OtherTok{*C*}\CommentTok{]}\NormalTok{\{\#Cref\} This is the conclusion.}
\end{Highlighting}
\end{Shaded}

In Pandoc markdown internal links are created with the syntax
\texttt{{[}link\ \ text{]}(\#target\_identifier)}. (Note the rounded
brackets instead of curly ones for Span elements.) When an internal link
to a custom-label item has no text, the filter replaces it with the
label text. For instance, given the custom labelled list above, the
following markdown:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{The claim [](\#A1ref) together with the claim [](\#A2ref) }
\NormalTok{entail ([](\#Cref)).}
\end{Highlighting}
\end{Shaded}

will be converted to:

\begin{quote}
The claim \href{}{\textbf{A1}} together with the claim \href{}{A2}
entail (\href{}{\emph{C}}).
\end{quote}

Note that the label's formatting is preserved and no brackets are added.
In the last cross-reference link here we have added brackets around the
link to get them in the output.

\hypertarget{examples-and-tests}{%
\subsection{Examples and tests}\label{examples-and-tests}}

\hypertarget{math-formulas}{%
\subsubsection{math formulas}\label{math-formulas}}

\begin{itemize}
\tightlist

\item[(\(p_1\))] This list uses

\item[(\(p_2\))] math formulas as labels.

\end{itemize}

\hypertarget{latex-code}{%
\subsubsection{LaTeX code}\label{latex-code}}

\begin{itemize}
\tightlist
\item
  {\textbf{a}} This list uses
\item
  {\textbf{b}} latex code as labels.
\end{itemize}

Ignored: these are not treated as labels.

\hypertarget{small-caps}{%
\subsubsection{Small caps}\label{small-caps}}

\begin{itemize}
\tightlist

\item[(\textsc{All})] This list uses

\item[(\textsc{Some})] latex code as labels.

\end{itemize}

\hypertarget{list-with-para-items}{%
\subsubsection{List with Para items}\label{list-with-para-items}}

\begin{itemize}
\tightlist

\item[(A1)] \[F(x) > G(x)\]

\item[(A2)] \[G(x) > H(x)\]

\end{itemize}

\hypertarget{items-with-several-blocks}{%
\subsubsection{items with several
blocks}\label{items-with-several-blocks}}

\begin{itemize}
\tightlist

\item[(\textbf{B1})] This list's items

consist of several blocks

\[\sum_i Fi > \sum_i Gi\]

\item[(\textbf{B2})] Lorem ipsum dolor sit amet, consectetur adipiscing
elit. Donec et massa ut eros volutpat gravida ut vel lacus. Proin turpis
eros, imperdiet sed quam eget, bibendum aliquam massa. Phasellus
pellentesque egestas dapibus. Proin porta tellus id orci consectetur
bibendum. Nam eu cursus quam. Etiam vehicula in mi sed interdum. Duis
rutrum eleifend consectetur. Phasellus ullamcorper, urna at vestibulum
venenatis, tellus erat luctus nibh, eget hendrerit justo enim nec magna.
Duis mollis ac felis ac tristique.

Pellentesque malesuada arcu ac orci scelerisque vulputate. Aenean at ex
suscipit, ultricies tellus sit amet, luctus lectus. Duis ut viverra
sapien. Pellentesque habitant morbi tristique senectus et netus et
malesuada fames ac turpis egestas. Cras consequat nisi at ex finibus, in
condimentum erat auctor. In at nulla at est iaculis pulvinar sed id
diam. Cras malesuada sit amet tellus id molestie.

\end{itemize}

\hypertarget{cross-referenced-custom-labels}{%
\subsubsection{cross-referenced custom
labels}\label{cross-referenced-custom-labels}}

\begin{itemize}
\tightlist

\item[(\textbf{A1})\labelledlistlabel{A1ref}{\textbf{A1}}] This is the
first claim.

\item[(A2)\labelledlistlabel{A2ref}{A2}] This is the second claim.

\item[(\emph{C})\labelledlistlabel{Cref}{\emph{C}}] This is the
conclusion.

\end{itemize}

The claim \ref{A1ref} together with the claim \ref{A2ref} entail
(\ref{Cref}).

\hypertarget{details}{%
\subsection{Details}\label{details}}

\hypertarget{latex-output}{%
\subsubsection{LaTeX output}\label{latex-output}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{\textbackslash{}begin}\NormalTok{\{}\ExtensionTok{itemize}\NormalTok{\}}
\FunctionTok{\textbackslash{}tightlist}

\FunctionTok{\textbackslash{}item}\NormalTok{[(Premise 1)] This is the first claim.}

\FunctionTok{\textbackslash{}item}\NormalTok{[(Premise 2)] This is the second claim.}

\FunctionTok{\textbackslash{}item}\NormalTok{[(Conclusion)] This is the conclusion.}

\KeywordTok{\textbackslash{}end}\NormalTok{\{}\ExtensionTok{itemize}\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{html-output}{%
\subsubsection{HTML output}\label{html-output}}

HTML output is a \texttt{\textless{}div\textgreater{}}. Each item is a
\texttt{\textless{}p\textgreater{}} if it's one block long, a
\texttt{\textless{}div\textgreater{}} if longer. The label itself is
contained in a \texttt{\textless{}span\textgreater{}}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{\textless{}div} \ErrorTok{class}\OtherTok{=}\StringTok{"labelled{-}lists{-}list"}\KeywordTok{\textgreater{}}
  \KeywordTok{\textless{}p} \ErrorTok{class}\OtherTok{=}\StringTok{"labelled{-}lists{-}item"}\KeywordTok{\textgreater{}\textless{}span} \ErrorTok{class}\OtherTok{=}\StringTok{"labelled{-}lists{-}label"}\KeywordTok{\textgreater{}}\NormalTok{(Premise 1)}\KeywordTok{\textless{}/span\textgreater{}}\NormalTok{ This is the first claim.}\KeywordTok{\textless{}/p\textgreater{}}
  \KeywordTok{\textless{}p} \ErrorTok{class}\OtherTok{=}\StringTok{"labelled{-}lists{-}item"}\KeywordTok{\textgreater{}\textless{}span} \ErrorTok{class}\OtherTok{=}\StringTok{"labelled{-}lists{-}label"}\KeywordTok{\textgreater{}}\NormalTok{(Premise 2)}\KeywordTok{\textless{}/span\textgreater{}}\NormalTok{ This is the second claim.}\KeywordTok{\textless{}/p\textgreater{}}
  \KeywordTok{\textless{}div} \ErrorTok{class}\OtherTok{=}\StringTok{"labelled{-}lists{-}item"}\KeywordTok{\textgreater{}}
    \KeywordTok{\textless{}p\textgreater{}\textless{}span} \ErrorTok{class}\OtherTok{=}\StringTok{"labelled{-}lists{-}label"}\KeywordTok{\textgreater{}}\NormalTok{(}\KeywordTok{\textless{}strong\textgreater{}}\NormalTok{Conclusion}\KeywordTok{\textless{}/strong\textgreater{}}\NormalTok{)}\KeywordTok{\textless{}/span\textgreater{}}\NormalTok{ This third item consists of}\KeywordTok{\textless{}/p\textgreater{}}
    \KeywordTok{\textless{}p\textgreater{}}\NormalTok{two blocks.}\KeywordTok{\textless{}/p\textgreater{}}
  \KeywordTok{\textless{}/div\textgreater{}}
\KeywordTok{\textless{}/div\textgreater{}}
\end{Highlighting}
\end{Shaded}

\hypertarget{list-structures}{%
\subsubsection{List structures}\label{list-structures}}

\begin{itemize}
\tightlist
\item
  In the Pandoc AST, each item is a list of blocks. If the item has only
  one block, the list will contain only one element.
\item
  If an item has only one block, that block's type can be at least:

  \begin{itemize}
  \tightlist
  \item
    Plain, if it only contains straightforward markdown
  \item
    Para, if it contains some equation LaTeX code (and perhaps in other
    cases too)
  \item
    Table if it contains a table.
  \end{itemize}
\item
  It an item has several blocks, they will be Para by default, otherwise
  of whatever type the block is.
\item
  If an item is only one block, it is either a Plain element (if it only
  contains straightforward markdown) or a Para element (if it contains
  some LaTeX code or equation)
\end{itemize}

\end{document}
